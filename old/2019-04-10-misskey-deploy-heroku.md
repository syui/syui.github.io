+++
date = "2019-04-10"
tags = ["misskey","heroku"]
title = "misskeyにheroku deploy buttonを付けてみた"
slug = "misskey-heroku-deploy"
+++

今回は、[misskey](https://github.com/syuilo/misskey)にherokuへのdeployを簡単にするボタンを付けてみた時の話をします。

とはいえ、一応、自分なりの考えは、ちょびっとだけ書いといたほうがいいだろうとも思ったので、ほんの少しだけなにか書きます。適当にですけど。

あ、ボタンの方はこちらになります。forkしてコードをちょっとだけ変更して付けました。

https://github.com/syui/misskey/tree/v10

では、なんでこんなボタン作ったのか、ですね。

この前、偶然にもこんな言葉をどこかで読みました。

> 作り手とその取り巻きだけが楽しんでる間は本物じゃない。その中身が理解できない人々の生活を変えてこそ本物だ

なんというか...すごくいい言葉なのかもしれませんね。なんのことか意味がよくわからないけど。

とりあえずその話は置いといて、ソフトウェアを最初に触わるときって、何もかも全部把握し、完璧に理解した上で動かしてる人って多くないと思うんですよね。普通、動かしてるうちに、色々把握したり、理解したりするもんじゃないですか、というのが私の考えです。

それが自分の管理下にないサーバー上のことならなおさらですよね。必要な設定の値とかもわかりませんし、それをデプロイしながら把握していくのでは時間がかかってしまいます。もちろん、それ以外にもわからないことだらけですよね、初めて触るんだから当然です。

ここで、例えば、あなたがなにかのツールをインストールしようとして、もしインストールに失敗したり、動かなかったりした場合、どうしますか。

これはいろいろな人がいると思うんです。

頑張ってエラーを修正しようとする人、諦めて他のものを使ってみる人、色々頑張ってみてそれでダメだったらさっぱりやめてしまう人、色々です。

このようなとき、とりあえず簡単に動かせる、動いてるってのは、初見の人にとってすごく重要なことだと思うんです。

みなさんも、なにかを初めて動かそうとするときって、大抵、そうじゃないですか。

もちろん、それは違うって人もいると思うんですけど、私は、はじめての人にとって、簡単に・できるってことは、すごく重要なことだと思うんです。

では、もう一度、冒頭に引用した言葉を思い出してみることにしましょう。

> 作り手とその取り巻きだけが楽しんでる間は本物じゃない。その中身が理解できない人々の生活を変えてこそ本物だ

...相変わらず、再度読んでみても、さっぱりよくわからない言葉ですね!

ここで、デプロイボタンがあれば、少しだけ簡単に、初見の人にも簡単に、できたりしますので、嬉しいし、楽しいと思いました。それだけ。

次に、どうやってボタンつけたかの話です。

これは、load.tsを変更して付けました。load.tsは、設定ファイルを読み込んでその内容を反映する非常に根幹的なファイルコードです。これを変更するというのは、正直、躊躇しました。

ただ、環境変数がある場合にそれを用いるというのは、よくあることです。また、その処理を分割するか否か迷うところではありますが、従来から存在するそこに処理を書いたほうがわかりやすいと思います。

これは、もともとPORTという環境変数があれば、それを使うようにする変更があったので、同じような処理を同じ場所に追加したとしても不自然ではありません。

しかし、ここでは、そんなこと以上に大切なことがあります。それは、単に私の行動原理に過ぎませんが、もしかしたら多くの開発者の行動原理かもしれませんね。

またまた、言葉の引用になりますが、最近、ドラゴンボールを読み返してみたんですよね。

読み返してみると、亀仙人いるじゃないですか。あやつは、なかなかにいいことをいうておるんですよね。

例えば、亀仙人、こんなことをいうておるんです。めんどくさそうなところは飛ばして、趣旨だけ述べると

> 武道を習得するのは、喧嘩に勝つためではなく、ギャルに褒められるためでもない。武道を学ぶことによって心身ともに健康となり、それによって人生を面白おかしく過ごしてしまおうというものじゃ!

みたいなことを言っとるんです。んで、この言葉を聞いた悟空は、ぜんぜんわからんとか言うんですが、要するに「一生懸命に修行して人生を楽しく暮らしちゃおうということだ!!」ってことみたいです。

つまりですね、私、個人の行動原理として、「人生を楽しく」ってことが大切だと思ってるんです。これはプライベートで開発してる人の多くが、例えば、プルリクを送る側であれ、受け取る側であれ、人生は楽しいほうがいいよ、みたいなことだと思うです。(もはやわけわからん

例えば、自分がプルリクを送るとしたら、それは、楽しそうだったからでしょうね、多分。

しかし、もしそれが楽しくなかったら...嫌なことばかりだったらどうでしょう。例えば、その楽しくなさそーな雰囲気を自分が作り出してしまっているとしたら...もはや最悪ですね。私でも「あんた、さっさといなくなってくれたほうがいいよ」って言いいますよ。んで、その場合は、さっさとその場を去るのが一番でしょう。自分がやらかしてるんだから当たり前です。そして、それは、自分のためでもあり...しかし、それだけでもなく。

つまりですね、できれば、人生、楽しみたいものですよね。自分も、周りも。

そんなことを意味不明にも思っておりまして、私の行動原理って、割とそんなところが多いですから、それに従って、行動することが多い気がしてます。

misskeyに幸あれ

以上
