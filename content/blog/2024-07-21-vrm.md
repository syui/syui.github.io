+++
date = "2024-07-21"
tags = ["ue","ue5", "vrm"]
title = "vroidでマントを作る"
+++

アイの衣装を作っています。走っている姿があまり可愛くないのでマントを付けてみることにしました。原因はおそらくデフォルトの姿勢だと思われます。

<video controls style="width:100%;"><source src="/m/post/ue/ue5_2024-07-21_01.mp4"></video>

しかし、vroidでマントは相当難しいです。

## マントの作り方と調整

vroidで髪の毛から作りました。したがって、頭の動きと連動します。

調整は`髪の揺れ方`から行います。動かしたいboneを追加して、ボーン数は少ないほど安定します。これで動く場所を追加します。固定点はどこからboneを始めるかを決めます。かたさは数字が小さいほど固い動きになります。衝突半径はboneを基準にカプセルのようなものを追加して衝突の有無を判定するのでしょう。

マントは以下を基準に設定しました。

- ボーン : 1
- 固定点 : 0.6
- かたさ : 0.1
- 重力 : 0
- 衝突半径 : 0.01 

この値だけでもダメで上向きにすることが必要です。これ以外では貫通してしまいました。本当はもう少し下向きがいいですね。

<img src="/m/post/ue/ue5_2024-07-21_01.png">

## 体を貫通する

マントが体を貫通します。

これは現時点でどうしようもない問題です。あらゆるパラメータを調整しても貫通してしまい、無理やりなんとかしようとすると、今度は後ろ髪とのバッティングが発生し、髪の毛がごちゃごちゃに動くようになります。

マントを上向きにしているのは走ると体を貫通してしまうからです。

できる限り貫通しないようにしましたが、完璧は無理でしょう。

## boneを増やすのは良くない

固定値を根本から設定し、boneを増やして衝突半径を大きくすることで貫通を解消する事ができるかもしれません。

しかし、マントの動きが安定しなくなってしまいます。

