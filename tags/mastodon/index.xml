<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mastodon on syui.github.io</title>
    <link>https://syui.github.io/tags/mastodon/</link>
    <description>Recent content in Mastodon on syui.github.io</description>
    <generator>Hugo</generator>
    <language>ja-jp</language>
    <copyright>&amp;copy; syui</copyright>
    <lastBuildDate>Mon, 20 May 2024 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://syui.github.io/tags/mastodon/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>linkの集約</title>
      <link>https://syui.github.io/blog/post/2024/05/20/bluesky/</link>
      <pubDate>Mon, 20 May 2024 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2024/05/20/bluesky/</guid>
      <description>&lt;p&gt;今までいろんなサービスや自前運用をやってみて、ある程度の期間使ってみて、自分は何を使えばいいのかが定まってきたので、そのへんの知見を共有します。&lt;/p&gt;&#xA;&lt;p&gt;最も一般的なのは以下の2つです。&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;github&lt;/li&gt;&#xA;&lt;li&gt;twitter&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;次に、いわゆるgeekと呼ばれる人達はそこから移行する傾向にあります。例えば、コンピュータサイエンスの人などはmastodonで発信することが増えています。&lt;/p&gt;&#xA;&lt;p&gt;個性派の人は以下のうちどちらか1つを使うのがいいでしょう。&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;gitea / forgejo&lt;/li&gt;&#xA;&lt;li&gt;mastodon / bluesky&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;blueskyは簡単にpdsを建てられます。pdsを建て&lt;code&gt;bsky.network&lt;/code&gt;に参加すれば連合できます。&lt;/p&gt;&#xA;&lt;p&gt;linkは基本的にsnsとvcsの2つあればいいと思っています。&lt;/p&gt;&#xA;&lt;p&gt;その他に私が利用したものは以下の通りです。&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;matrix / discord&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;使用頻度はかなり低いです。&lt;code&gt;atproto&lt;/code&gt;がそのうちchatに対応してくれるといいですね。&lt;/p&gt;&#xA;&lt;h2 id=&#34;domain&#34;&gt;domain&lt;/h2&gt;&#xA;&lt;p&gt;現在持っているdomainは以下の3つです。&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;syui.ai&lt;/li&gt;&#xA;&lt;li&gt;syui.ai&lt;/li&gt;&#xA;&lt;li&gt;syu.is&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;増えてきているので1つにまとめたい。でも1つだとテストなどで不便なことがあります。&lt;/p&gt;&#xA;&lt;h2 id=&#34;個人的ベスト&#34;&gt;個人的ベスト&lt;/h2&gt;&#xA;&lt;p&gt;ここでlinkを集約するための合理的かつシンプルな方法はなんでしょう。&lt;/p&gt;&#xA;&lt;p&gt;domainは1つは持っておきたいものですよね。&lt;/p&gt;&#xA;&lt;p&gt;したがって、最も合理的かつシンプルに考えると、そのdomainに全て集約するのがベストです。&lt;/p&gt;&#xA;&lt;p&gt;個人的には&lt;code&gt;syui.ai&lt;/code&gt;に集約するのが一番いいと思っています。&lt;/p&gt;&#xA;&lt;p&gt;現時点でsns, vcsも&lt;code&gt;syui.ai&lt;/code&gt;を実用しているので、それ以外のアカウントを削除すれば実現可能。&lt;/p&gt;&#xA;&lt;p&gt;しかし、それをやると相当な不便が伴います。&lt;/p&gt;&#xA;&lt;p&gt;多くの開発者はgithubを利用しているので、issueを書くにもgithubのアカウントがいるでしょう。twitterも同じです。そして、domainは1つだけ持つのが理想的ですが、開発用途やサービス上の問題から2つ以上ないと困ることがあります。&lt;/p&gt;&#xA;&lt;h2 id=&#34;理想と現実&#34;&gt;理想と現実&lt;/h2&gt;&#xA;&lt;p&gt;完全な理想でいうとこうなります。&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;host&lt;/th&gt;&#xA;          &lt;th&gt;type&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syui.ai&lt;/td&gt;&#xA;          &lt;td&gt;all&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;p&gt;妥協的な理想はこうなります。&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;account&lt;/th&gt;&#xA;          &lt;th&gt;type&lt;/th&gt;&#xA;          &lt;th&gt;protocol&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syui.ai&lt;/td&gt;&#xA;          &lt;td&gt;web&lt;/td&gt;&#xA;          &lt;td&gt;http&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;@syui.ai&lt;/td&gt;&#xA;          &lt;td&gt;sns&lt;/td&gt;&#xA;          &lt;td&gt;at&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;@git.syui.ai:syui&lt;/td&gt;&#xA;          &lt;td&gt;vcs&lt;/td&gt;&#xA;          &lt;td&gt;git&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;p&gt;現実的にはこれがベストです。&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;account&lt;/th&gt;&#xA;          &lt;th&gt;type&lt;/th&gt;&#xA;          &lt;th&gt;protocol&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syui__&lt;/td&gt;&#xA;          &lt;td&gt;sns&lt;/td&gt;&#xA;          &lt;td&gt;twitter.com&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syui&lt;/td&gt;&#xA;          &lt;td&gt;vcs&lt;/td&gt;&#xA;          &lt;td&gt;github.com&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;p&gt;実際のlinkはさらに増えていきます。&lt;/p&gt;&#xA;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;account&lt;/th&gt;&#xA;          &lt;th&gt;type&lt;/th&gt;&#xA;          &lt;th&gt;protocol&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syui__&lt;/td&gt;&#xA;          &lt;td&gt;sns&lt;/td&gt;&#xA;          &lt;td&gt;twitter.com&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syui&lt;/td&gt;&#xA;          &lt;td&gt;vcs&lt;/td&gt;&#xA;          &lt;td&gt;github.com&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syuw&lt;/td&gt;&#xA;          &lt;td&gt;chat&lt;/td&gt;&#xA;          &lt;td&gt;discord.com&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syai&lt;/td&gt;&#xA;          &lt;td&gt;video&lt;/td&gt;&#xA;          &lt;td&gt;youtube.com&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;syui.ai&lt;/td&gt;&#xA;          &lt;td&gt;web&lt;/td&gt;&#xA;          &lt;td&gt;http&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;@syui.ai&lt;/td&gt;&#xA;          &lt;td&gt;sns&lt;/td&gt;&#xA;          &lt;td&gt;at&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;@syui@syui.ai&lt;/td&gt;&#xA;          &lt;td&gt;sns&lt;/td&gt;&#xA;          &lt;td&gt;activitypub&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;@syui:syui.ai&lt;/td&gt;&#xA;          &lt;td&gt;chat&lt;/td&gt;&#xA;          &lt;td&gt;matrix&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;@git.syui.ai:syui&lt;/td&gt;&#xA;          &lt;td&gt;vcs&lt;/td&gt;&#xA;          &lt;td&gt;git&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;h2 id=&#34;どうすればいいのか&#34;&gt;どうすればいいのか&lt;/h2&gt;&#xA;&lt;p&gt;最もよく使うsns, vcsの2つに絞ります。そのうえで自身が一般派と個性派のどちらに所属しているかを見極めます。&lt;/p&gt;</description>
    </item>
    <item>
      <title>mastodonにbotを立ててみた</title>
      <link>https://syui.github.io/blog/post/2022/12/03/msbot/</link>
      <pubDate>Sat, 03 Dec 2022 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2022/12/03/msbot/</guid>
      <description>&lt;p&gt;この前、botでも立ててみようかなと思ったので、mastodon(single-mode)にbotを立ててみることにしました。&lt;/p&gt;&#xA;&lt;p&gt;rustで書いてたclientを拡張できたので、とてもよかった。botの構築には今使ってるclientを組み込むことにしました。&lt;/p&gt;&#xA;&lt;p&gt;例えば、botに話しかけると&amp;hellip;賢すぎる。bot、すごい。&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/syui/img/master/other/mastodon_bot_20221203_0004.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;今できるのは、mastodonをupdateしたり&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/syui/img/master/other/mastodon_bot_20221203_0001.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;commitやdockerを見たり、検索したり&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/syui/img/master/other/mastodon_bot_20221203_0002.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;codeをreviewしてもらったり&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/syui/img/master/other/mastodon_bot_20221203_0000.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;画像を生成してもらったり&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/syui/img/master/other/mastodon_bot_20221203_0003.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;などができます。&lt;/p&gt;&#xA;&lt;p&gt;呼び出しをmentionにしたのは、負担を軽くするためかな。timelineを監視するより、notify(通知)を監視したほうが負担は少なそう。&lt;/p&gt;&#xA;&lt;p&gt;botはserverに常駐させるため、できる限り負担は少ないほうがいいですし、また、mastodon server(web server)自体を自分が運営してることもあり、api request、つまりweb serverへの負担も少ないほうがよさそう。&lt;/p&gt;&#xA;&lt;p&gt;timelineを毎回取得、あるいはlatestのみの取得でもあっても、頻繁に更新される性質があるため、notifyの取得のほうがserverへの負担は少ないと思われます。微々たるもので、あまり変わらないかもしれませんが。&lt;/p&gt;&#xA;&lt;p&gt;とりあえず、botを立ててよかった。楽しい。&lt;/p&gt;</description>
    </item>
    <item>
      <title>fly.ioとmastodon</title>
      <link>https://syui.github.io/blog/post/2022/11/17/mastodon/</link>
      <pubDate>Thu, 17 Nov 2022 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2022/11/17/mastodon/</guid>
      <description>&lt;p&gt;&lt;code&gt;fly.io&lt;/code&gt;を使ってみて、数ヶ月が経過したのでレビューです。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://fly.io&#34;&gt;https://fly.io&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;fly.ioでは&lt;a href=&#34;https://github.com/mastodon/mastodon&#34;&gt;mastodon&lt;/a&gt;を動かしており、安定して動作しています。&lt;/p&gt;&#xA;&lt;p&gt;したがって、fly.ioの評価は最高です。cliからも使いやすく、一度立ち上げると、dockerfileを使用することもあり、トラブルが起こりにくい印象。&lt;/p&gt;&#xA;&lt;p&gt;また、毎月&lt;code&gt;$5&lt;/code&gt;以内ならサービスしてくれるようで、数ヶ月の運用が&lt;code&gt;$0&lt;/code&gt;でした。この辺も非常にありがたい。&lt;/p&gt;&#xA;&lt;p&gt;fly.ioのようなサービスは個人開発者、特に趣味でやっている開発者にとって必要です。例えば、投資家の方々や大企業は、fly.ioのスポンサーしてくれると嬉しい。&lt;/p&gt;&#xA;&lt;p&gt;fly.ioは非常におすすめです。&lt;/p&gt;&#xA;&lt;p&gt;最近になってmastodonにbotを入れました。&lt;/p&gt;&#xA;&lt;p&gt;botを作るの楽しいのと、前から使っていたclientが改良されていくので嬉しい。botは&lt;a href=&#34;https://www.archlinux.jp/&#34;&gt;archlinux&lt;/a&gt;で動いています。&lt;/p&gt;&#xA;&lt;p&gt;clientは以下のframework等を使うと非常に便利。&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/ksk001100/seahorse&#34;&gt;https://github.com/ksk001100/seahorse&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://docs.rs/mammut/latest/mammut/&#34;&gt;https://docs.rs/mammut/latest/mammut/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;botにdiffusionコマンドを追加したんだけど、そのおかげで画像生成する機会が増えました。&lt;a href=&#34;https://github.com/CompVis/stable-diffusion&#34;&gt;stable-diffusion&lt;/a&gt;は、面倒で全く触ってなかった。&lt;/p&gt;&#xA;&lt;p&gt;新しい絵もできました。AIと手書きの合作です。&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://syui.github.io/img/yui_124.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;上記の絵はAIとの合作なのですが、生成した画像の人物が崩れていて、もったいないと思ったので、人物を手書きすることにしました。以下の2つが元になっています。&lt;/p&gt;&#xA;&lt;iframe src=&#34;https://mastodon.social/@syui/109358065305956601/embed&#34; class=&#34;mastodon-embed&#34; style=&#34;max-width: 100%; border: 0&#34; width=&#34;400&#34; allowfullscreen=&#34;allowfullscreen&#34;&gt;&lt;/iframe&gt;&lt;script src=&#34;https://static-cdn.mastodon.social/embed.js&#34; async=&#34;async&#34;&gt;&lt;/script&gt;&#xA;&lt;iframe src=&#34;https://mastodon.social/@syui/109362755591494337/embed&#34; class=&#34;mastodon-embed&#34; style=&#34;max-width: 100%; border: 0&#34; width=&#34;400&#34; allowfullscreen=&#34;allowfullscreen&#34;&gt;&lt;/iframe&gt;&lt;script src=&#34;https://static-cdn.mastodon.social/embed.js&#34; async=&#34;async&#34;&gt;&lt;/script&gt;&#xA;&lt;p&gt;手動で画風を合わせるの、けっこう大変。&lt;/p&gt;</description>
    </item>
    <item>
      <title>mastodonが紫になった</title>
      <link>https://syui.github.io/blog/post/2022/06/11/mastodon/</link>
      <pubDate>Sat, 11 Jun 2022 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2022/06/11/mastodon/</guid>
      <description>&lt;p&gt;mastodonのアイコンが紫になった。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/mastodon/mastodon/pull/18592&#34;&gt;https://github.com/mastodon/mastodon/pull/18592&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;グラデーションがついてて、上の方が若干明るくなってる感じ。&lt;/p&gt;&#xA;&lt;p&gt;mastodonとtwitterの青色(系統)が同じなのは、例えば、並べてアイコン載せるときとかに視認性がよくないと思っていて、今回の変更は個人的に嬉しい。&lt;/p&gt;</description>
    </item>
    <item>
      <title>mammutのexampleをまとめてみる</title>
      <link>https://syui.github.io/blog/post/2022/02/06/rust-mammut/</link>
      <pubDate>Sun, 06 Feb 2022 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2022/02/06/rust-mammut/</guid>
      <description>&lt;p&gt;mastodon apiのrust libである&lt;a href=&#34;https://docs.rs/mammut/latest/mammut/&#34;&gt;mammut&lt;/a&gt;ですが、exampleがあるとわかりやすいと思ったので、作ってみました。&lt;/p&gt;&#xA;&lt;p&gt;まず、mastodonへのrequestはこんな感じになります。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;curl -H &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Content-Type: application/json&amp;#34;&lt;/span&gt; -X POST -Ss https://$host/oauth/token &lt;span style=&#34;color:#ae81ff&#34;&gt;\&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;&#x9;-d &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&#x9;&#x9;\&amp;#34;client_id\&amp;#34;: \&amp;#34;&lt;/span&gt;$client_id&lt;span style=&#34;color:#e6db74&#34;&gt;\&amp;#34;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&#x9;&#x9;\&amp;#34;client_secret\&amp;#34;: \&amp;#34;&lt;/span&gt;$client_secret&lt;span style=&#34;color:#e6db74&#34;&gt;\&amp;#34;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&#x9;&#x9;\&amp;#34;grant_type\&amp;#34;: \&amp;#34;password\&amp;#34;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&#x9;&#x9;\&amp;#34;username\&amp;#34;: \&amp;#34;&lt;/span&gt;$username&lt;span style=&#34;color:#e6db74&#34;&gt;\&amp;#34;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&#x9;&#x9;\&amp;#34;password\&amp;#34;: \&amp;#34;&lt;/span&gt;$password&lt;span style=&#34;color:#e6db74&#34;&gt;\&amp;#34;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&#x9;&#x9;\&amp;#34;scope\&amp;#34;: \&amp;#34;&lt;/span&gt;$scope&lt;span style=&#34;color:#e6db74&#34;&gt;\&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&#x9;}&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;mammutでは&lt;code&gt;Data&lt;/code&gt;として認証に必要な要素がまとめられてますので、各種要素を入れて&lt;code&gt;Mastodon::from_data(data)&lt;/code&gt;すると認証できます。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-toml:Cargo.toml&#34; data-lang=&#34;toml:Cargo.toml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#a6e22e&#34;&gt;package&lt;/span&gt;]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;name&lt;/span&gt; = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;test&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;version&lt;/span&gt; = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;0.0.1&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#a6e22e&#34;&gt;dependencies&lt;/span&gt;]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;dotenv&lt;/span&gt; = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;0.15&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mammut&lt;/span&gt; = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;0.13.0&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-rust:src/main.rs&#34; data-lang=&#34;rust:src/main.rs&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;crate&lt;/span&gt; mammut;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;crate&lt;/span&gt; dotenv;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::env;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; mammut::{Data, Mastodon};&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;mammut&lt;/span&gt;::Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;()&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Data {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        base: &lt;span style=&#34;color:#a6e22e&#34;&gt;env&lt;/span&gt;::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;BASE&amp;#34;&lt;/span&gt;).unwrap().into(),&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        client_id: &lt;span style=&#34;color:#a6e22e&#34;&gt;env&lt;/span&gt;::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CLIENT_ID&amp;#34;&lt;/span&gt;).unwrap().into(),&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        client_secret: &lt;span style=&#34;color:#a6e22e&#34;&gt;env&lt;/span&gt;::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CLIENT_SECRET&amp;#34;&lt;/span&gt;).unwrap().into(),&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        redirect: &lt;span style=&#34;color:#a6e22e&#34;&gt;env&lt;/span&gt;::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;REDIRECT&amp;#34;&lt;/span&gt;).unwrap().into(),&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        token: &lt;span style=&#34;color:#a6e22e&#34;&gt;env&lt;/span&gt;::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;TOKEN&amp;#34;&lt;/span&gt;).unwrap().into(),&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    };&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; mastodon &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Mastodon::from_data(data);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; t &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mastodon.verify_credentials();&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    println!(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;{:?}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;, t);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    Ok(())&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh:.env&#34; data-lang=&#34;sh:.env&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;export TOKEN&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;export CLIENT_ID&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;export CLIENT_SECRET&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;export REDIRECT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;export BASE&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;https://mstdn.syui.ai&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cargo run&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ./target/debug/test&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Data : &lt;a href=&#34;https://docs.rs/mammut/latest/mammut/struct.Data.html&#34;&gt;https://docs.rs/mammut/latest/mammut/struct.Data.html&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>rustでmastodon clientをはじめてみた</title>
      <link>https://syui.github.io/blog/post/2022/02/05/rust/</link>
      <pubDate>Sat, 05 Feb 2022 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2022/02/05/rust/</guid>
      <description>&lt;p&gt;今までmastodonはzshでapi叩いてやってたんですが、他言語でもclientを作ろうかなと前々から思ってて、今回はrustではじめてみた。&lt;/p&gt;&#xA;&lt;p&gt;大抵の場合、本人が使うときにしか機能追加されない模様。&lt;/p&gt;&#xA;&lt;p&gt;使ってるうち便利にしていければと思ってます。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/syui/msr&#34;&gt;https://github.com/syui/msr&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>mastodonをruby-3.0.3で動かしてみた</title>
      <link>https://syui.github.io/blog/post/2021/12/05/mastodon/</link>
      <pubDate>Sun, 05 Dec 2021 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2021/12/05/mastodon/</guid>
      <description>&lt;p&gt;今までrbenvでversion管理してたんだけど、archlinuxにruby-3.0.3が来ていたので、これがmastodonのgemfileと合いそうだったので上げてみた。heroku-runtimeも3.0.3ですし、今だとrbenvは必要ありません。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cd mastodon&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ rbenv local system&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ ruby -v&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;3.0.3&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ sudo gem i bundler&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ export PATH&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$HOME&lt;span style=&#34;color:#e6db74&#34;&gt;/.gem/ruby/3.0.0/bin:&lt;/span&gt;$PATH&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ rm Gemfile.lock&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ bundle&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;あとは&lt;code&gt;Gemfile.lock&lt;/code&gt;をherokuにcommit, deployすればいいです。&lt;/p&gt;&#xA;&lt;p&gt;また、nodeのnpm(yarn)でerrが出てたので、package.jsonも変更してます。&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json:package.json&#34; data-lang=&#34;json:package.json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;engines&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;:&lt;/span&gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;node&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;12.13.0&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;最新のmastodonではkeybaseのリンクが消滅しています。下記の事情があったみたいです。したがって、当該commitをrevertすることでリンク(認証)を残すことができます。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/mastodon/mastodon/issues/13670&#34;&gt;https://github.com/mastodon/mastodon/issues/13670&lt;/a&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git revert 7de0ee7ab&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;iframe src=&#34;https://mastodon.zunda.ninja/@zundan/107345100219354734/embed&#34; class=&#34;mastodon-embed&#34; style=&#34;max-width: 100%; border: 0&#34; width=&#34;400&#34; allowfullscreen=&#34;allowfullscreen&#34;&gt;&lt;/iframe&gt;&#xA;&lt;h3 id=&#34;その他のリンク&#34;&gt;その他のリンク&lt;/h3&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://devcenter.heroku.com/ja/articles/ruby-support&#34;&gt;https://devcenter.heroku.com/ja/articles/ruby-support&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://devcenter.heroku.com/ja/articles/nodejs-support&#34;&gt;https://devcenter.heroku.com/ja/articles/nodejs-support&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://docs.joinmastodon.org/user/contacts/&#34;&gt;https://docs.joinmastodon.org/user/contacts/&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>mastodonでcommit-hashとdeploy-rubyをあわせて表示してみる</title>
      <link>https://syui.github.io/blog/post/2021/05/10/mastodon/</link>
      <pubDate>Mon, 10 May 2021 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2021/05/10/mastodon/</guid>
      <description>&lt;p&gt;mastodonって下の方に現在のverが表示されてますよね。ここに、commit-hashとrubyを表示するやつを&lt;a href=&#34;https://mastodon.zunda.ninja/@zundan&#34;&gt;zunda&lt;/a&gt;さんがpull-reqついでに開発してたので、それを使うといいでしょう。herokuでは&lt;code&gt;SOURCE_VERSION&lt;/code&gt;からhashを取れるっぽい。&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/zunda/mastodon/pull/27/files&#34;&gt;https://github.com/zunda/mastodon/pull/27/files&lt;/a&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-ruby:lib/tasks/version.rake&#34; data-lang=&#34;ruby:lib/tasks/version.rake&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;namespace &lt;span style=&#34;color:#e6db74&#34;&gt;:source&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  desc &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Record source version&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  task &lt;span style=&#34;color:#e6db74&#34;&gt;:version&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    hash &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;ENV&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SOURCE_VERSION&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;# available on Heroku while build&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; hash&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;blank?&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;begin&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        hash &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;`git rev-parse HEAD 2&amp;gt;/dev/null`&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strip&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# ignore the error: fatal: Not a git repository&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;rescue&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;Errno&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;ENOENT&lt;/span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;# git command is not available&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;unless&lt;/span&gt; hash&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;blank?&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      hash_abb &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; hash&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;..&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;File&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;open(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;config/initializers/version.rb&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;f&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        f&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;~&lt;/span&gt;_TEMPLATE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#75715e&#34;&gt;# frozen_string_literal: true&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;module&lt;/span&gt; Mastodon&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;module&lt;/span&gt; Version&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#66d9ef&#34;&gt;module_function&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;suffix&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; at &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;#{&lt;/span&gt;hash_abb&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; on ruby-&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;#{&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;RUBY_VERSION&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;repository&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tootsuite/mastodon&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;source_tag&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;#{&lt;/span&gt;hash&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;              &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;          &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        _TEMPLATE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;end&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;task &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;assets:precompile&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;source:version&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;rake assets:precompile&lt;/code&gt;で&lt;code&gt;config/initializers/version.rb&lt;/code&gt;が生成される仕組みで、表示はこの&lt;code&gt;version.rb&lt;/code&gt;を参照します。形式は以下のような感じ。&lt;/p&gt;</description>
    </item>
    <item>
      <title>mastodon v3.4.0をruby v3.0.1でdeployしてみた</title>
      <link>https://syui.github.io/blog/post/2021/05/09/mastodon/</link>
      <pubDate>Sun, 09 May 2021 00:00:00 +0000</pubDate>
      <guid>https://syui.github.io/blog/post/2021/05/09/mastodon/</guid>
      <description>&lt;p&gt;mastodon v3.4.0のpre-verがmasterにcommitされています。&lt;/p&gt;&#xA;&lt;p&gt;heroku-20は&lt;code&gt;ruby v3.0.1&lt;/code&gt;に対応していて、mastodon v3.4.0は&lt;code&gt;ruby &amp;lt; v3.1.0&lt;/code&gt;なので、heroku(deploy-server)のruby verを上げてみました。Gemfile.lockをheroku用に更新してdeployすればokです。&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Heroku supports the following Ruby versions and the associated Rubygems. A supported version means that you can expect our tools and platform to work with a given version. It also means you can receive technical support. Here are our supported Ruby versions:&lt;/p&gt;&#xA;&lt;p&gt;2.6.7, Rubygems: 3.0.3.1&lt;/p&gt;&#xA;&lt;p&gt;2.7.3, Rubygems: 3.1.6&lt;/p&gt;&#xA;&lt;p&gt;3.0.1, Rubygems: 3.2.15&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://devcenter.heroku.com/articles/ruby-support#ruby-versions&#34;&gt;https://devcenter.heroku.com/articles/ruby-support#ruby-versions&lt;/a&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git clone https://github.com/tootsuite/mastodon&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cd ./mastodon&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ heroku git:remote -a $app&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ rm Gemfile.lock&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ rbenv install 3.0.1 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ rbenv local 3.0.1&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ rbenv version&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ gem i bundler&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ bundle&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git add .&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git commit -m &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;update gemlock ruby3.0.1&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# git push heroku master&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git push heroku main &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ heroku run RAILS_ENV&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;production bundle exec rails db:migrate&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ heroku run RAILS_ENV&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;production bin/tootctl cache clear&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ heroku run RAILS_ENV&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;production bundle exec rails assets:precompile&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
  </channel>
</rss>
